<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>giosg API Reference - Javascript API</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

  </head>

  <body class="javascript_api">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
      <ul class="toc-footer">
        <li><a href='./index.html'>Giosg HTTP API</a></li>
        <li><a href='./javascript_api.html'>JavaScript SDK API</a></li>
        <li><a href='./giosg_apps.html'>Giosg APPS</a></li>
        <li><a href='./basket.html'>Giosg BASKET</a></li>
      </ul>
      <ul class="toc-footer">
        <li><a href='http://www.giosg.com' target="_blank">Sign Up on giosg.com</a></li>
        <li><a href="https://docs.giosg.com/doku.php?id=public:technical-documentation:backend-api" target="_blank">Old API documentation</a></li>
        <li><a href='https://github.com/tripit/slate' target="_blank">Documentation Powered by Slate</a></li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="visitor-javascript-api">Visitor Javascript API</h1>

<h2 id="requirements-and-general-usage">Requirements and general usage</h2>
<pre class="highlight javascript"><code><span class="c1">// Asynchronous API call</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'visitor'</span><span class="p">,</span> <span class="s1">'submit'</span><span class="p">,</span> <span class="p">{</span> <span class="na">username</span><span class="p">:</span> <span class="s1">'John Doe'</span> <span class="p">});</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// Normal API call</span>
<span class="kd">function</span> <span class="nx">success</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Success!'</span><span class="p">);</span>
<span class="p">};</span>
<span class="kd">function</span> <span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Error: '</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// Wait for giosg client to fully load</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Following is equivalent of:</span>
    <span class="c1">// _giosg('visitor', 'submit', { username: 'John Doe' });</span>
    <span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">visitor</span><span class="p">.</span><span class="nx">submit</span><span class="p">({</span> <span class="na">username</span><span class="p">:</span> <span class="s1">'John Doe'</span> <span class="p">})</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">success</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<p>To use giosg visitor javascript api you need to be using latest version of <a title="giosg script tag" href="http://docs.giosg.com/doku.php?id=public:technical-documentation:installation-instructions">giosg script tag</a> on the site.</p>

<p>The best practice is to include giosg script at the start of the HTML document. This is not necessary but is advised so that the <code class="prettyprint">_giosg</code> object is
available as soon as possible.</p>

<p>Javascript api can be used in two ways. Asynchronously with <code class="prettyprint">_giosg</code> object or calling api method&rsquo;s directly. <code class="prettyprint">_giosg</code> object is available right after
<a title="giosg script tag" href="http://docs.giosg.com/doku.php?id=public:technical-documentation:installation-instructions">giosg script tag</a> so you don&rsquo;t need to wait for giosg to be fully loaded before calling api.</p>

<p>Sometimes it is however useful to know when the api calls complete. For that reason you can also call giosg api methods directly and receive jQuery
promise as return value. When you want to call api methods directly it is important to wrap your code inside <code class="prettyprint">_giosg(function () { ... });</code> to make sure that
giosg client is fully loaded before the call is made.</p>

<p><strong>Following api calls are identical:</strong></p>

<p><code class="prettyprint">_giosg(&#39;visitor&#39;, &#39;submit&#39;, &lt;visitor_data&gt;, &lt;signing_algorithm&gt;, &lt;replace_existing&gt;, &lt;room_information&gt;);</code></p>

<p>AND</p>

<p><code class="prettyprint">_giosg(function () { giosg.api.visitor.submit({ username: &#39;John Doe&#39; }).then(success, error); });</code></p>

<p>This documentation uses only asynchronous versions of API&rsquo;s as examples from this point on. To &ldquo;convert&rdquo; asynchronous call to normal api call
use following pattern:</p>

<p><code class="prettyprint">_giosg(&#39;module&#39;, &#39;method&#39;, arg1, arg2, ..)</code> translates to <code class="prettyprint">giosg.api.&lt;module&gt;.&lt;method&gt;(arg1, arg2, ..);</code></p>

<h2 id="visitor-data-api">Visitor data API</h2>

<p>You can attach key value pairs to visitor with giosg javascript api. This data is then available to operators in giosg console and also in reporting.
Data can also be signed so that you can trust that the submitted data originated from you and was not tampered by visitor.</p>

<h3 id="submit-visitor-data">Submit visitor data</h3>
<pre class="highlight javascript"><code><span class="c1">// Attach data to visitor</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'visitor'</span><span class="p">,</span> <span class="s1">'submit'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">username</span><span class="p">:</span> <span class="s1">'John Doe'</span><span class="p">,</span>
    <span class="na">age</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span>
    <span class="na">has_car</span><span class="p">:</span><span class="kc">true</span>
<span class="p">},</span> <span class="s1">'plain'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'My room'</span> <span class="p">});</span>
</code></pre>

<p>Javascript call:</p>

<p><code class="prettyprint">_giosg(&#39;visitor&#39;, &#39;submit&#39;, &lt;visitor_data&gt;, &lt;signing_algorithm&gt;, &lt;replace_existing&gt;, &lt;room_information&gt;);</code></p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">visitor_data</code></td>
<td>Object</td>
<td><strong>required</strong></td>
<td>JSON serializable object containing key value pairs. Object can contain attributes of any names. <code class="prettyprint">username</code> attribute has special meaning. It is displayed as visitor&rsquo;s name in chat dialog and reports. Example: <code class="prettyprint">{ username: &#39;John Doe&#39; }</code></td>
</tr>
<tr>
<td><code class="prettyprint">signing_algorithm</code></td>
<td>String</td>
<td>optional</td>
<td>String identifying which algorithm is used for signing. Default is &lsquo;plain&rsquo; which means no signing. See full list of supported algorithms below.</td>
</tr>
<tr>
<td><code class="prettyprint">replace_existing</code></td>
<td>Bool</td>
<td>optional</td>
<td>If set to <code class="prettyprint">true</code> will replace existing data that was attached to visitor. Otherwise existing data will be extended with new values. Default is <code class="prettyprint">false</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">room_information</code></td>
<td>Array</td>
<td>optional</td>
<td>Array of room information objects. This parameter controls the room where the data will be connected. If not set, it will default to domain room. Room info object has to contain either <code class="prettyprint">id</code> or <code class="prettyprint">name</code> attribute. Example: <code class="prettyprint">[{ name: &#39;My custom room&#39; }]</code></td>
</tr>
</tbody></table>

<h3 id="submit-visitor-data-to-multiple-rooms-at-once">Submit visitor data to multiple rooms at once</h3>
<pre class="highlight javascript"><code><span class="c1">// Attach data to visitor and make it available on multiple rooms.</span>
<span class="kd">var</span> <span class="nx">roomInfo</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="na">id</span><span class="p">:</span> <span class="s1">'kbio5de27gjo767wcqaafh7g6mpluvar4ofiausuac7acbam'</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'Another room'</span>
<span class="p">}];</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'visitor'</span><span class="p">,</span> <span class="s1">'submit'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">username</span><span class="p">:</span> <span class="s1">'John Doe'</span><span class="p">,</span>
    <span class="na">age</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span>
    <span class="na">has_car</span><span class="p">:</span><span class="kc">true</span>
<span class="p">},</span> <span class="s1">'plain'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">roomInfo</span><span class="p">);</span>
</code></pre>

<p>It is possible to submit data to multiple rooms at once by passing array as <code class="prettyprint">&lt;room_information&gt;</code> parameter.</p>

<p>Javascript call:</p>

<p><code class="prettyprint">_giosg(&#39;visitor&#39;, &#39;submit&#39;, &lt;visitor_data&gt;, &lt;signing_algorithm&gt;, &lt;replace_existing&gt;, [&lt;room_information&gt;]);</code></p>

<h3 id="signing-visitor-data">Signing visitor data</h3>
<pre class="highlight javascript"><code><span class="c1">// Example of submitting JWT signed visitor data</span>
<span class="kd">var</span> <span class="nx">jwt_payload</span> <span class="o">=</span> <span class="s1">'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb21pY191cmwiOiJodHRwOi8veGtjZC5jb20vMTM2MC8ifQ.BsjBt9a9imoj9P5_7aIAe5nuhPd5jb8HGvAJKPCwm6A'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">algorithm</span> <span class="o">=</span> <span class="s1">'HS256'</span><span class="p">;</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'visitor'</span><span class="p">,</span> <span class="s1">'submit'</span><span class="p">,</span> <span class="nx">jwt_payload</span><span class="p">,</span> <span class="nx">algorithm</span><span class="p">);</span>

<span class="c1">// Example of submitting SHA1/MD5 signed visitor data</span>
<span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">username</span><span class="p">:</span> <span class="s1">'Django signed'</span><span class="p">,</span>
    <span class="na">email</span><span class="p">:</span><span class="s1">'django@giosg.com'</span><span class="p">,</span>
    <span class="na">_checksum</span><span class="p">:</span><span class="s1">'e584526251c396fc937e27561c9597c8'</span><span class="p">,</span>
    <span class="na">_exp</span><span class="p">:</span><span class="s1">'1371720939'</span>
<span class="p">};</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'visitor'</span><span class="p">,</span> <span class="s1">'submit'</span><span class="p">,</span> <span class="nx">payload</span><span class="p">,</span> <span class="s1">'md5'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

</code></pre>

<p>Signing is used for validating that data is not altered by web page&rsquo;s visitor. If signing is required for domain and checksum is not set or it&rsquo;s wrong, then giosg will reject the data and HTTP status 400 will be returned.</p>

<p>There is two different options for signing data: JSON Web Token specification (JWT) and simple sha1/md5. JSON Web Token specification is recommended with HMAC SHA-256 hash algorithm.</p>

<p><strong>Please note</strong> that signed data can be still seen by visitor but cannot be modifed anyway without giosg being able to recognize that and then reject data.</p>

<p><strong>Javascript call:</strong></p>

<p><code class="prettyprint">_giosg(&#39;visitor&#39;, &#39;submit&#39;, &lt;jwt_payload&gt;, &lt;signing_algorithm&gt;);</code></p>

<p><strong>jwt_payload</strong> is json web token generated from payload data. Note that payload data may contain property <strong>exp</strong> that contains token expiration time as a UTC UNIX timestamp (an int). This will be used to check if token is still valid.</p>

<p><strong>signing_algorithm</strong> is algorithm used. This is required.</p>

<h3 id="supported-signing-algorithms">Supported signing algorithms</h3>

<table><thead>
<tr>
<th>Algorithm</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">HS256</code></td>
<td>JWT</td>
<td> HMAC using SHA-256 hash algorithm (recommended)</td>
</tr>
<tr>
<td><code class="prettyprint">HS384</code></td>
<td>JWT</td>
<td> HMAC using SHA-384 hash algorithm</td>
</tr>
<tr>
<td><code class="prettyprint">HS512</code></td>
<td>JWT</td>
<td> HMAC using SHA-512 hash algorithm</td>
</tr>
<tr>
<td><code class="prettyprint">RS256</code></td>
<td>JWT</td>
<td> RSASSA-PKCS1-v1_5 signature algorithm using SHA-256 hash algorithm</td>
</tr>
<tr>
<td><code class="prettyprint">RS384</code></td>
<td>JWT</td>
<td> RSASSA-PKCS1-v1_5 signature algorithm using SHA-384 hash algorithm</td>
</tr>
<tr>
<td><code class="prettyprint">RS512</code></td>
<td>JWT</td>
<td> RSASSA-PKCS1-v1_5 signature algorithm using SHA-512 hash algorithm</td>
</tr>
<tr>
<td><code class="prettyprint">sha1</code></td>
<td>hash</td>
<td>SHA-1 (Secure Hash Algorithm 1)</td>
</tr>
<tr>
<td><code class="prettyprint">md5</code></td>
<td>hash</td>
<td>MD5 message-digest algorithm</td>
</tr>
</tbody></table>

<h3 id="generating-signed-payload-with-jwt">Generating signed payload with JWT</h3>
<pre class="highlight python"><code><span class="c"># 1. Install PyJWT</span>
<span class="c"># 2. open python shell and run:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">jwt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">time</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span> <span class="c"># 30 seconds in future</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"comic_url"</span><span class="p">:</span> <span class="s">"http://xkcd.com/1360/"</span><span class="p">,</span> <span class="s">"exp"</span><span class="p">:</span> <span class="n">exp</span> <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="s">"supersecretkey"</span><span class="p">,</span> <span class="s">"HS256"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">token</span>
<span class="s">'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb21pY191cmwiOiJodHRwOi8veGtjZC5jb20vMTM2MC8ifQ.BsjBt9a9imoj9P5_7aIAe5nuhPd5jb8HGvAJKPCwm6A'</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre>

<p>Example of generating JWT token with Python can be found from the right.</p>

<p>You can find more information about JWT from these resources:</p>

<ul>
<li>JWT Specification: <a href="#">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-20</a></li>
<li>Python: <a href="#">https://pypi.python.org/pypi/PyJWT/0.2.1</a></li>
<li>PHP: <a href="#">https://github.com/firebase/php-jwt</a></li>
<li>Java: <a href="#">https://github.com/auth0/java-jwt</a></li>
<li>Asp.Net: <a href="#">https://www.nuget.org/packages/JWT</a></li>
</ul>

<h3 id="generating-signed-payload-with-sha1-md5">Generating signed payload with SHA1/MD5</h3>
<pre class="highlight python"><code><span class="c"># Open python shell and run:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">hashlib</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">secret_key</span> <span class="o">=</span> <span class="s">'supersecret'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'username'</span><span class="p">:</span> <span class="s">'John Doe'</span><span class="p">,</span> <span class="s">'age'</span><span class="p">:</span> <span class="mi">29</span> <span class="p">};</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">concatenated_payload</span> <span class="o">=</span> <span class="s">''</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">concatenated_payload</span> <span class="o">+=</span> <span class="s">'</span><span class="si">%</span><span class="s">s:</span><span class="si">%</span><span class="s">s&amp;'</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">concatenated_payload</span> <span class="o">+=</span> <span class="n">secret_key</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">checksum</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">concatenated_payload</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">checksum</span>
<span class="s">'0ea59ee5af5fa0aba76f1a6fd209d396'</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre>

<p>Checksum is calculated on server side by using md5 or sha1 algorithm. For checksum calculation payload data need&rsquo;s to be formatted in specific way as a string.
First JSON paylod parameters must be sorted alphabetically. Then every parameter and it&rsquo;s value need&rsquo;s to be delimited with <code class="prettyprint">:</code>.
Delimiter between multiple key/value pairs is <code class="prettyprint">&amp;</code>. Then checksum need&rsquo;s to be calculated from that string and appended secret key.</p>

<p>After calculation checksum need&rsquo;s to be placed inside payload JSON in <code class="prettyprint">_checksum</code> field. It is also recommended that <code class="prettyprint">_exp</code> field is present on payload
and contains checksum expiration time as a UTC UNIX timestamp (an int).</p>

<p><strong>Note:</strong> Boolean values should be lower case if present. For example checkbox:true. Null values are not recommended.</p>

<p>Example of generating md5 checksum with Python can be found from the right.</p>

<h3 id="remove-submitted-data">Remove submitted data</h3>
<pre class="highlight javascript"><code><span class="c1">// Remove single key from visitor data</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'visitor'</span><span class="p">,</span> <span class="s1">'remove'</span><span class="p">,</span> <span class="s1">'username'</span><span class="p">);</span>

<span class="c1">// Clear all data from visitor</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'visitor'</span><span class="p">,</span> <span class="s1">'removeAll'</span><span class="p">);</span>

</code></pre>

<p>It is also possible to remove submitted data from visitor.</p>

<p><strong>Remove single data key from visitor:</strong></p>

<p><code class="prettyprint">_giosg(&#39;visitor&#39;, &#39;remove&#39;, &lt;key&gt;);</code></p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">key</code></td>
<td>String</td>
<td><strong>required</strong></td>
<td>Attribute from previously submitted api data that should be removed.</td>
</tr>
</tbody></table>

<p><strong>Remove all previously added data from visitor:</strong></p>

<p><code class="prettyprint">_giosg(&#39;visitor&#39;, &#39;removeAll&#39;);</code></p>

<h2 id="visitor-rooms-api">Visitor rooms API</h2>

<p>With javascript rooms API you can control which rooms visitor will be connected to.</p>

<h3 id="join-visitor-to-room">Join visitor to room</h3>
<pre class="highlight javascript"><code><span class="c1">// Join visitor to room with room ID</span>
<span class="kd">var</span> <span class="nx">roomInfo</span> <span class="o">=</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span>
    <span class="s1">'swugkoy472m5tdg4lyaafmnl4xtbs2ar4sxtq4c2w2z2wzym'</span>
<span class="p">};</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'room'</span><span class="p">,</span> <span class="s1">'join'</span><span class="p">,</span> <span class="nx">roomInfo</span><span class="p">);</span>

<span class="c1">// Join visitor to room with room name</span>
<span class="kd">var</span> <span class="nx">roomInfo</span> <span class="o">=</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Special room'</span> <span class="p">};</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'room'</span><span class="p">,</span> <span class="s1">'join'</span><span class="p">,</span> <span class="nx">roomInfo</span><span class="p">);</span>

<span class="c1">// Join visitor to multiple room's with once call</span>
<span class="kd">var</span> <span class="nx">roomInfo</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="na">id</span><span class="p">:</span> <span class="s1">'swugkoy472m5tdg4lyaafmnl4xtbs2ar4sxtq4c2w2z2wzym'</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'Sales'</span>
<span class="p">}];</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'room'</span><span class="p">,</span> <span class="s1">'join'</span><span class="p">,</span> <span class="nx">roomInfo</span><span class="p">);</span>
</code></pre>

<p>Javascript call:</p>

<p><code class="prettyprint">_giosg(&#39;room&#39;, &#39;join&#39;, &lt;room_information&gt;);</code></p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">room_information</code></td>
<td>Array</td>
<td><strong>required</strong></td>
<td>Array of room information objects. This parameter controls what rooms visitor will join to. Room info object has to contain either <code class="prettyprint">id</code> or <code class="prettyprint">name</code> attribute. Example: <code class="prettyprint">[{ name: &#39;My custom room&#39; }]</code></td>
</tr>
</tbody></table>

<h3 id="leave-visitor-from-room">Leave visitor from room</h3>
<pre class="highlight javascript"><code><span class="c1">// Leave visitor from room by id</span>
<span class="kd">var</span> <span class="nx">roomInfo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span><span class="s1">'swugkoy472m5tdg4lyaafmnl4xtbs2ar4sxtq4c2w2z2wzym'</span>
<span class="p">};</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'room'</span><span class="p">,</span> <span class="s1">'leave'</span><span class="p">,</span> <span class="nx">roomInfo</span><span class="p">);</span>

<span class="c1">// Leave visitor from room by name</span>
<span class="kd">var</span> <span class="nx">roomInfo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span><span class="s1">'Support room'</span>
<span class="p">};</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'room'</span><span class="p">,</span> <span class="s1">'leave'</span><span class="p">,</span> <span class="nx">roomInfo</span><span class="p">);</span>

<span class="c1">// Leave visitor from all rooms expect domain room.</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'room'</span><span class="p">,</span> <span class="s1">'leave'</span><span class="p">);</span>
</code></pre>

<p>Javascript call:</p>

<p><code class="prettyprint">_giosg(&#39;room&#39;, &#39;leave&#39;, &lt;room_information&gt;);</code></p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">room_information</code></td>
<td>Array</td>
<td>optional</td>
<td>Array of room information objects. This parameter controls what rooms to leave. If not set, visitor will leave all rooms expect domain room. Room info object has to contain either <code class="prettyprint">id</code> or <code class="prettyprint">name</code> attribute. Example: <code class="prettyprint">[{ name: &#39;My custom room&#39; }]</code></td>
</tr>
</tbody></table>

<h2 id="visitor-chat-api">Visitor chat API</h2>

<p>With javascript chat API it is possible to force ending of chat conversation and/or hiding a chat window if a visitor for example logs out from your application.</p>

<h3 id="end-chat-session">End chat session</h3>
<pre class="highlight javascript"><code><span class="c1">// Close all open chats for this visitor</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">,</span> <span class="p">{</span> <span class="na">all</span><span class="p">:</span><span class="kc">true</span> <span class="p">});</span>
<span class="c1">// or</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">);</span>


<span class="c1">// Close all open chats for this visitor and hide the visitor's chat window</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">,</span> <span class="p">{</span> <span class="na">hide</span><span class="p">:</span><span class="kc">true</span> <span class="p">});</span>


<span class="c1">// Close specific chat session with parent room ID</span>
<span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="s1">'sgek3zw6h3orokc4giaafcxcm72zx3qr4sqzk3cabcw7p2am'</span>
<span class="p">};</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">,</span> <span class="nx">opts</span><span class="p">);</span>


<span class="c1">// Close chat from specific parent room with room name</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">,</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span><span class="s1">'Sales room'</span> <span class="p">});</span>


<span class="c1">// You can also show a message to user, specify "sender"</span>
<span class="c1">// of this message and clear existing history.</span>
<span class="kd">var</span> <span class="nx">roomData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">message</span><span class="p">:</span> <span class="s1">'Chat conversations has ended!'</span><span class="p">,</span>
    <span class="na">messageSender</span><span class="p">:</span> <span class="s1">'Chat service'</span><span class="p">,</span>
    <span class="na">clearHistory</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">};</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">,</span> <span class="nx">roomData</span><span class="p">);</span>
</code></pre>

<p>Javascript call:</p>

<p><code class="prettyprint">_giosg(&#39;chat&#39;, &#39;close&#39;, &lt;options&gt;);</code></p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">options</code></td>
<td>Object</td>
<td>optional</td>
<td>Options object. See possible option values below</td>
</tr>
</tbody></table>

<p><strong>Possible attributes for options object:</strong></p>

<table><thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">all</code></td>
<td>Bool</td>
<td>optional</td>
<td>If set to true, close all open chat sessions</td>
</tr>
<tr>
<td><code class="prettyprint">hide</code></td>
<td>Bool</td>
<td>optional</td>
<td>If set to true, hides chat window also.</td>
</tr>
<tr>
<td><code class="prettyprint">id</code></td>
<td>String</td>
<td>optional</td>
<td>ID of the room where to close the chat session from.</td>
</tr>
<tr>
<td><code class="prettyprint">name</code></td>
<td>String      optional</td>
<td>Name of the room where to close the chat session from.</td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">clearHistory</code></td>
<td>Bool</td>
<td>optional</td>
<td>If set to true, clear&rsquo;s all visitors chat history. This doesn&rsquo;t remove data from database but from client only!</td>
</tr>
<tr>
<td><code class="prettyprint">message</code></td>
<td>String</td>
<td>ptional</td>
<td>Show a message to user when chat session is closed</td>
</tr>
<tr>
<td><code class="prettyprint">messageSender</code></td>
<td>String</td>
<td>optional</td>
<td>Set sender of the <code class="prettyprint">message</code>. This option only applies if <code class="prettyprint">message</code> is specified also.</td>
</tr>
</tbody></table>

<h3 id="hide-chat">Hide chat</h3>
<pre class="highlight javascript"><code><span class="c1">// Close chat window</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'hide'</span><span class="p">);</span>


<span class="c1">// Close chat window without affection other tabs</span>
<span class="c1">// where chat window might be open.</span>
<span class="nx">_giosg</span><span class="p">(</span><span class="s1">'chat'</span><span class="p">,</span> <span class="s1">'hide'</span><span class="p">,</span> <span class="p">{</span> <span class="na">preserveWindowState</span><span class="p">:</span><span class="kc">true</span> <span class="p">});</span>
</code></pre>

<p>Hide a chat from a visitor without closing the chat session.</p>

<p>Javascript call:</p>

<p><code class="prettyprint">_giosg(&#39;chat&#39;, &#39;hide&#39;, &lt;options&gt;);</code></p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">options</code></td>
<td>Object</td>
<td>optional</td>
<td>Options object. See possible option values from below.</td>
</tr>
</tbody></table>

<p><strong>Possible attributes for options object:</strong></p>

<table><thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">preserveWindowState</code></td>
<td>Object</td>
<td>If <code class="prettyprint">preserveWindowState</code> is set to <code class="prettyprint">true</code> will not affect other tabs where window might be open.</td>
</tr>
</tbody></table>

          <aside class="warning">
This documentation is a <strong>draft</strong>!
</aside>

<h1 id="giosg-sdk-api">Giosg SDK API</h1>

<h2 id="setup">Setup</h2>

<h3 id="set-permission-token">Set permission token</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">setPermissionToken</span><span class="p">(</span><span class="nx">permissionJWT</span><span class="p">);</span>
</code></pre>

<p>Set the permission token used for all the actions for the Giosg SDK. Setting a new token replaces the previous one.</p>

<h2 id="rooms">Rooms</h2>

<h3 id="room-basic-info-and-state">Room basic info and state</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">rooms</span><span class="p">.</span><span class="nx">streamRoom</span><span class="p">(</span><span class="nx">roomId</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>Example room</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8e91795e-99ef-4f9a-8d09-04995333651f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test room"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_any_operator_online"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Endpoint/channel:</p>

<p><code class="prettyprint">/api/v5/client/rooms/&lt;room_id&gt;</code></p>

<p>Permission to get a status for any known room:</p>

<p><code class="prettyprint">/api/v5/client/rooms/*</code></p>

<h3 id="collection-of-joined-rooms">Collection of joined rooms</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">rooms</span><span class="p">.</span><span class="nx">streamJoinedRooms</span><span class="p">().</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<p>You can stream the array of room IDs to which the visitor is currently being joined.</p>

<aside class="info">
This information is only shared between those Giosg SDK instances that are connected to the same proxy master.
</aside>

<h3 id="join-a-room">Join a room</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">rooms</span><span class="p">.</span><span class="nx">joinRoom</span><span class="p">(</span><span class="nx">roomId</span><span class="p">);</span>
</code></pre>

<p>Joins to the given room. Performing this action while already being joined to the room has no effect.</p>

<aside class="info">
This information is only shared between those Giosg SDK instances that are connected to the same proxy master.
</aside>

<h3 id="leave-a-room">Leave a room</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">rooms</span><span class="p">.</span><span class="nx">joinRoom</span><span class="p">(</span><span class="nx">roomId</span><span class="p">);</span>
</code></pre>

<p>Leaves from the given room. Performing this action while not being joined to the room has no effect.</p>

<aside class="info">
This information is only shared between those Giosg SDK instances that are connected to the same proxy master.
</aside>

<h2 id="visitor-and-operators">Visitor and operators</h2>

<h3 id="online-operators">Online operators</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">rooms</span><span class="p">.</span><span class="nx">streamOnlineOperators</span><span class="p">(</span><span class="nx">roomId</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>Example collection of online operators</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f0190b71-7ea3-4308-b4b9-48039c3e2367"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fe7f863-fcf8-4102-866a-4a677d8f32a0"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://giosg-chat-public-eu.s3.amazonaws.com/img/customer/personnel/yrKMbV50gCedS4ilJOaqRGNFHxAz1s.png"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Streams snapshots of operators that are currently online in the room. The stream emits a new snapshot of operator objects whenever they are added, removed or changed. Avatar is either an object or <code class="prettyprint">null</code> if the operator has no avatar.</p>

<p>Endpoint/channel:</p>

<p><code class="prettyprint">/api/v5/client/rooms/&lt;room_id&gt;/online_operators</code></p>

<p>Permission to get online operators for any known room:</p>

<p><code class="prettyprint">/api/v5/client/rooms/*/online_operators</code></p>

<h3 id="visitor-39-s-state">Visitor&rsquo;s state</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">visitor</span><span class="p">.</span><span class="nx">streamMyself</span><span class="p">().</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>Example visitor resource</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"133f73c7-08d3-4c01-86e8-aa8603e7bf37"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"typing_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"idle"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Endpoint/channel:</p>

<p><code class="prettyprint">/api/v5/client/visitors/&lt;visitor_id&gt;</code></p>

<p>Permission to get the state for one specific visitor:</p>

<p><code class="prettyprint">/api/v5/client/visitors/133f73c7-08d3-4c01-86e8-aa8603e7bf37</code></p>

<h2 id="chats">Chats</h2>

<h3 id="chats-for-a-visitor-in-a-room">Chats for a visitor in a room</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">visitor</span><span class="p">.</span><span class="nx">streamOwnChatsForRoom</span><span class="p">(</span><span class="nx">roomId</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>Example collection of chats</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b5a8f915-caa7-4c62-a95a-b4f84713ce95"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"is_visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"is_closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"visitor_message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"operator_message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3fee630f-304a-4621-9d2b-aadb358098e9"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"is_visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"is_closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"visitor_message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"operator_message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Endpoint/channel:</p>

<p><code class="prettyprint">/api/v5/client/visitors/&lt;visitor_id&gt;/rooms/&lt;room_id&gt;/chats</code></p>

<p>Permission to list chats for any known room for one specific visitor:</p>

<p><code class="prettyprint">/api/v5/client/visitors/133f73c7-08d3-4c01-86e8-aa8603e7bf37/rooms/*/chats</code></p>

<h3 id="single-chat">Single chat</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">streamChat</span><span class="p">(</span><span class="nx">chatId</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>Example chat resource</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b5a8f915-caa7-4c62-a95a-b4f84713ce95"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"visitor_message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"operator_message_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Endpoint/channel:</p>

<p><code class="prettyprint">/api/v5/client/visitors/&lt;visitor_id&gt;/chats/&lt;chat_id&gt;</code></p>

<p>Permission to get the state of a any known chat for one specific visitor:</p>

<p><code class="prettyprint">/api/v5/client/visitors/133f73c7-08d3-4c01-86e8-aa8603e7bf37/chats/*</code></p>

<h3 id="chat-participants">Chat participants</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">streamChatParticipants</span><span class="p">(</span><span class="nx">chatId</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>Example collection of participants</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f0190b71-7ea3-4308-b4b9-48039c3e2367"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"typing_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"typing"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"133f73c7-08d3-4c01-86e8-aa8603e7bf37"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"typing_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"idle"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a1966647-0ed7-4013-a99d-a28f69db694f"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Specialist"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"typing_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"typed"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>You can stream arrays of chat participant objects.
Whenever a participant is added or their attributes are changed, the stream emit a new snaphost of the participant list.
Type <code class="prettyprint">1</code> means visitor and <code class="prettyprint">2</code> means operator.</p>

<p>Endpoint/channel:</p>

<p><code class="prettyprint">/api/v5/client/visitors/&lt;visitor_id&gt;/chats/&lt;chat_id&gt;/participants</code></p>

<p>Permission to get chat participants of a any known chat for one specific visitor:</p>

<p><code class="prettyprint">/api/v5/client/visitors/133f73c7-08d3-4c01-86e8-aa8603e7bf37/chats/*/participants</code></p>

<h3 id="chat-logs">Chat logs</h3>
<pre class="highlight javascript"><code><span class="nx">giosg</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">streamRecentChatLogs</span><span class="p">(</span><span class="nx">chatId</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</code></pre>

<blockquote>
<p>Example collection of chat logs</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b5a8f915-caa7-4c62-a95a-b4f84713ce95"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"How may I help you?"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"sender_type"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"sender_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f0190b71-7ea3-4308-b4b9-48039c3e2367"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"sender_display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3fee630f-304a-4621-9d2b-aadb358098e9"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"I should buy a boat."</span><span class="p">,</span><span class="w">
        </span><span class="nt">"sender_type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"sender_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"133f73c7-08d3-4c01-86e8-aa8603e7bf37"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"sender_display_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>You can stream arrays of chat logs in the given chat.
Each new log message makes the stream emit a new snaphost of the chat log list.</p>

<aside class="warning">
If the chat has a relatively small amount of logs, then this always returns all the chat logs.
Only if the chat has a large amount of logs, then this only contains the latest chat logs.
</aside>

<p>Endpoint/channel:</p>

<p><code class="prettyprint">/api/v5/client/visitors/133f73c7-08d3-4c01-86e8-aa8603e7bf37/chats/&lt;chat_id&gt;/logs</code></p>

<p>Permission to get chat logs of a any known chat for one specific visitor:</p>

<p><code class="prettyprint">/api/v5/client/visitors/133f73c7-08d3-4c01-86e8-aa8603e7bf37/chats/*/logs</code></p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
