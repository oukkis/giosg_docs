<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>giosg API Reference - giosg APPS</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

  </head>

  <body class="giosg_apps">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
      <ul class="toc-footer">
        <li><a href='./index.html'>Home</a></li>
        <li><a href='./http_api.html'>Giosg HTTP API</a></li>
        <li><a href='./visitor_http_api.html'>Visitor HTTP API</a></li>
        <li><a href='./javascript_api.html'>JavaScript SDK API</a></li>
        <li><a href='./giosg_apps.html'>Giosg APPS</a></li>
        <li><a href='./basket.html'>Giosg BASKET</a></li>
      </ul>
      <ul class="toc-footer">
        <li><a href='http://www.giosg.com' target="_blank">Sign Up on giosg.com</a></li>
        <li><a href="https://docs.giosg.com/doku.php?id=public:technical-documentation:backend-api" target="_blank">Old API documentation</a></li>
        <li><a href='https://github.com/tripit/slate' target="_blank">Documentation Powered by Slate</a></li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="giosg-apps-developer-preview">Giosg APPS (Developer preview)</h1>

<aside class="warning">
This documentation is a <strong>draft</strong>!
</aside>

<p>Giosg APPS allow developers to develop own applications for giosg Live chat and embed them inside operator console much like canvas apps in Facebook.</p>

<p>Idea and usage of Giosg APPS is basically the same as in Facebook. You need to develop your own application with web technologies of your choice (examples and libs will be available for Angular-Meteor, Meteor and Django) and deploy to your own servers. You can then create your application to giosg.</p>

<p>Creating your application means defining name, description, image and application url. You also need to decide when the application will run and what permissions it needs. After saving you are ready to install and use the application.</p>

<h2 id="application-launch-conditions">Application launch conditions</h2>

<p>There are few different situation where applications can run. Application can run on background (Ie. no UI is shown to user) when console loads, chat starts or chat ends.</p>

<p>Applications can also run with visible UI when launched manually from chat dialog or from console top navigation. Running with visible UI means that the application is iframed in console either on own dialog or on the side of chat dialog.</p>

<h2 id="application-request">Application Request</h2>

<p>When application is launched a launch url will be generated for application. This url is combinations of configured application url and query string parameters generated by giosg. This url is then returned to client and client will create iframe with this url which results to GET requests to application. Data in query strings parameters is encoded to <a href="http://jwt.io/">JWT tokens</a>.</p>

<h3 id="list-of-parameters-in-application-request">List of parameters in application request</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">type</code></td>
<td>string</td>
<td> Type of request. Can be one of <code class="prettyprint">manual_dialog</code>, <code class="prettyprint">manual_nav</code>, <code class="prettyprint">chat_start</code>, <code class="prettyprint">chat_end</code> or <code class="prettyprint">console_load</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">data</code></td>
<td>JWT token</td>
<td> JWT Token signed with application secret. This contains data that application can use. See <strong>List of fields in data JWT Token</strong> below.</td>
</tr>
<tr>
<td><code class="prettyprint">token</code></td>
<td>JWT token</td>
<td> JWT token signed with giosg secret. This is used to authenticate with giosg HTTP Apis. See <strong>List of fields in token JWT Token</strong> below.</td>
</tr>
</tbody></table>
<pre class="highlight plaintext"><code>// Example of application request url:
https://myappp.com/app.html?type=chat_start&amp;data=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb21pY191cmwiOiJodHRwOi8veGtjZC5jb20vMTM2MC8ifQ.BsjBt9a9imoj9P5_7aIAe5nuhPd5jb8HGvAJKPCwm6A&amp;token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb21pY191cmwiOiJodHRwOi8veGtjZC5jb20vMTM2MC8ifQ.BsjBt9a9imoj9P5_7aIAe5nuhPd5jb8HG
</code></pre>

<p><strong>List of fields in <code class="prettyprint">data</code> JWT Token</strong></p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">sub</code></td>
<td>string</td>
<td> Subject of the token. Ie. <code class="prettyprint">service.giosg.com</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">exp</code></td>
<td>timestamp</td>
<td> Token expiration timestamp. Automatically used by most JWT implementations to make sure that token is not expired.</td>
</tr>
<tr>
<td><code class="prettyprint">user_id</code></td>
<td>UUID</td>
<td> UUID of the current user or <code class="prettyprint">None</code> if not applicable.</td>
</tr>
<tr>
<td><code class="prettyprint">org_id</code></td>
<td>UUID</td>
<td> UUID of the organization/company where the <code class="prettyprint">user_id</code> belongs to.</td>
</tr>
<tr>
<td><code class="prettyprint">chat_id</code></td>
<td>UUID</td>
<td> UUID of the chat sessions if applicable or <code class="prettyprint">None</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">visitor_id</code></td>
<td>VisitorID</td>
<td> ID of the visitor if applicable or <code class="prettyprint">None</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">inst_id</code></td>
<td>UUID</td>
<td> UUID of the application instance/installation.</td>
</tr>
<tr>
<td><code class="prettyprint">app_id</code></td>
<td>UUID</td>
<td> UUID of the application definition.</td>
</tr>
</tbody></table>

<p><strong>List of parameters <code class="prettyprint">token</code> JWT Token</strong></p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">sub</code></td>
<td>string</td>
<td> Subject of the token. Ie. <code class="prettyprint">service.giosg.com</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">exp</code></td>
<td>timestamp</td>
<td> Token expiration timestamp. Automatically used by most JWT implementations to make sure that token is not expired.</td>
</tr>
<tr>
<td><code class="prettyprint">user_id</code></td>
<td>UUID</td>
<td> UUID of the current user or <code class="prettyprint">None</code> if not applicable.</td>
</tr>
<tr>
<td><code class="prettyprint">org_id</code></td>
<td>UUID</td>
<td> UUID of the organization/company where the <code class="prettyprint">user_id</code> belongs to.</td>
</tr>
<tr>
<td><code class="prettyprint">inst_id</code></td>
<td>UUID</td>
<td> UUID of the application instance/installation.</td>
</tr>
<tr>
<td><code class="prettyprint">app_id</code></td>
<td>UUID</td>
<td> UUID of the application definition.</td>
</tr>
<tr>
<td><code class="prettyprint">perms</code></td>
<td> List of strings</td>
<td>  List of strings representing applications permission</td>
</tr>
</tbody></table>

<h3 id="why-two-jwt-tokens">Why two JWT tokens?</h3>

<p>There is two almost identical JWT tokens. First one, <strong>auth</strong> token,  is  for application server so that it can verify that the request was made by giosg and data was not tampered by anyway in the client. Another token is for giosg so that when application signs it&rsquo;s API calls with this token and app secret giosg can trust that the request originated from correct place.</p>

<h2 id="background-application-request">Background Application Request</h2>

<p>When application is run on background requests is made with celery and requests library. Normal GET request is made to application url with parameters in query string. This all the same as with normal application request except that the UI is not shown to user and javascript will not run.</p>

<h2 id="logging">Logging</h2>

<p>Application runs are always logged to log that is visible for the managers. This log contains information specially intended for debugging background requests.</p>

<h2 id="application-authentication-and-application-secret">Application authentication and Application secret</h2>

<p>When application is created an unique application secret will be generated for the application. Application need this secret key to authenticate to giosg. When applications request is made the receiving app receives JWT token containing request data and another token for authentication with giosg API&rsquo;s.</p>

<p>Applications can then verify the first token that was signed with the application secret so that they can trust data sent by giosg.</p>

<p>Clients (apps) should authenticate by passing both the JWT token that was provided in <strong>token</strong> query parameter and application secret in the &ldquo;Authorization&rdquo; HTTP header separated with space. &ldquo;Authorization&rdquo; header should be prefixed with <strong>GIOSGAPP</strong>.</p>
<pre class="highlight plaintext"><code>    Example:
        Auth token grabbed from request params:
            abcdefghiklmopqrstuvwxyz0213456789
        Giosg App Secret:
            axyz0213456bcdelmopqrstuvw789fghik
        Concatenate like this:
            auth = "{token} {secret}"

        Authorization: GIOSGAPP abcdefghiklmopqrstuvwxyz0213456789 axyz0213456bcdelmopqrstuvw789fghik
</code></pre>

<h2 id="ssl-is-required-for-apps-to-work">SSL is required for apps to work</h2>

<p>Applications are required to use SSL in order to be accepted as Giosg APPS. Currently UI allows saving pretty much anything as application url but requests will fail if the url doesn&rsquo;t start with HTTPS.</p>

<p>To develop apps locally it is possible to allow insecure urls by setting <code class="prettyprint">allow_insecure_url</code> to <code class="prettyprint">True</code> manually on database. No UI is provided for this to not make it too easy for some weak minded people to allow this for our customers! ;) Another possibility is to generate self signed certificate.</p>

<p>For production apps it is also possible to get free certificates from StartSSL and some other providers. Also it is possible to use CloudFlare in front of the app to get SSL for free.</p>

<h1 id="example-apps">Example apps</h1>

<p>Here are some example applications and boilerplates that you can use when you start building your own application. All of the apps are open source and can be used anyway you wish.</p>

<aside class="info">
[ChatToMail](https://github.com/giosg/chattomail_giosg_app).
</aside>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
